# IOC Extraction – Phishing Click Detection

This document contains the Indicators of Compromise (IOCs) identified during the SOC Home Lab phishing simulation.

The objective is to extract actionable artifacts from Sysmon logs that can be used for detection engineering, threat hunting, and incident response.

## Investigation Summary

During the phishing simulation:

- A phishing email was delivered via Gophish.
- The user clicked the malicious link.
- The browser initiated an outbound network connection.
- Sysmon generated Event ID 3 (Network Connection).

No payload execution or reverse shell activity occurred in this lab.

## 1️. Network Indicators

### Attacker IP Address

**IOC Type:** IP Address  
**Value:**
192.168.1.106


**Source:**  
Sysmon EventCode 3 – Network Connection

**Description:**  
Destination IP address hosting the phishing page (Kali attacker machine).

**Observed Behavior:**  
Browser process initiated outbound TCP connection over HTTP (Port 80).

### Phishing URL

**IOC Type:** URL  
**Value:**
http://192.168.1.106/?rid=TWUdkmw


**Description:**  
Phishing link containing a unique tracking parameter (`rid`) generated by Gophish.

**Significance:**  
Indicates user interaction with phishing content.

### Destination Ports
80 (HTTP)
443 (HTTPS)


**Description:**  
Outbound web traffic initiated by the browser.

Port 80 was used for the phishing page.  
Port 443 connections were observed but not confirmed as malicious.

## 2️. Host-Based Indicators

### Source Host
Hostname: umut
IP Address: 192.168.1.108
User: UMUT\User


**Description:**  
User workstation that initiated the suspicious connection.

### Browser Process

**IOC Type:** Process Image  
**Value:**
C:\Program Files (x86)\Microsoft\Edge\Application\msedge.exe


**Event Source:**  
Sysmon EventCode 3 – Network Connection

**Significance:**  
Represents user-driven interaction (phishing link click).  
Monitoring browser outbound connections is critical for phishing detection.

## 3️. Log Artifacts

### Sysmon Event ID
EventCode = 3


**Meaning:**  
Network connection detected.

**Purpose in Investigation:**  
Primary detection artifact for identifying phishing click activity.

### Process GUID (Example)
{0c1bba5c-9ded-69a0-d700-00000000ab00}


**Purpose:**  
Used to correlate process activity across multiple Sysmon events.

## 4️. Hash Artifacts (Visibility Demonstration)
SHA256=071B0D3A08503A8B88AEEDA1D20F371A563377028F6E252DC66CCE60AB8F823E


**Process:**  
MpSigStub.exe

**Note:**  
This hash was not malicious in the lab environment.  
Included to demonstrate hash extraction capability from Sysmon Event ID 1.

## 5️. IOC Summary Table

| IOC Type         | Value                  | Source Event   |
|------------------|------------------------|---------------|
| Attacker IP      | 192.168.1.106          | Sysmon Event 3 |
| Phishing URL     | /?rid=TWUdkmw          | Network Log    |
| Destination Port | 80 / 443               | Sysmon Event 3 |
| Process Image    | msedge.exe             | Sysmon Event 3 |
| Source Host      | 192.168.1.108          | Sysmon         |
| Hash (Demo)      | SHA256 (MpSigStub.exe) | Sysmon Event 1 |

## 6️. Detection Confidence Level

**Confidence Level:** Medium

**Reason:**

- User interaction confirmed.
- Outbound connection to attacker-controlled system observed.
- No payload execution or lateral movement detected.

## 7️. SOC Recommendations

- Block attacker IP address at firewall level (lab scenario).
- Monitor outbound HTTP connections initiated by browser processes.
- Correlate phishing email timestamps with network logs.
- Enrich suspicious IPs using threat intelligence sources.
- Implement alerting rule for abnormal outbound web traffic.

End of IOC Extraction Report

