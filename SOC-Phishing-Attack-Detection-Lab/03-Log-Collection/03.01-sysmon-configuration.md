# Sysmon Configuration and Event Logging

This document describes the configuration of **Sysmon** on the Windows 10 target machine in the SOC Phishing Attack Lab.  

Sysmon provides detailed system activity logs to help SOC analysts detect suspicious behavior.

---

## 1.1 Installation

1. Download Sysmon from the [Microsoft Sysinternals](https://docs.microsoft.com/en-us/sysinternals/downloads/sysmon) site.  
2. Install with command prompt (run as Administrator):
   ```powershell
   Sysmon64.exe -i -accepteula -h sha256 -l
   
-i → Install Sysmon

-accepteula → Accept license

-h sha256 → Enable file hash logging

-l → Include loading information

---

## 2. Sysmon Configuration

The Sysmon configuration includes monitoring for:

Event ID 1 – Process Creation

Event ID 3 – Network Connection

Event ID 5 – Process Termination

Example configuration snippet (XML):
```html
<Sysmon schemaversion="4.50">
  <EventFiltering>
    <ProcessCreate onmatch="include">
      <Image condition="is">C:\Windows\System32\*</Image>
    </ProcessCreate>
    <NetworkConnect onmatch="include" />
    <ProcessTerminate onmatch="include" />
  </EventFiltering>
</Sysmon>
```

---

## 3. Event IDs Overview
Event ID	Description
1	Process Creation
3	Network Connection
5	Process Termination

Logs are stored in Microsoft-Windows-Sysmon/Operational

These events are later forwarded to Splunk for SOC analysis

---

## 4. Notes

Sysmon should always run with administrator privileges for full monitoring

Configurations can be updated with XML filters to include or exclude processes, network connections, or specific events

Monitoring these events is essential for detecting phishing-related activity, malicious processes, and unusual network traffic
