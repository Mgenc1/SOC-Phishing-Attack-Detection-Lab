# Log Forwarding to Splunk

## 1. Overview

In this lab environment, Windows Sysmon logs were centrally collected and analyzed using Splunk Enterprise running on an Ubuntu server.

The log collection architecture:

Windows 10 (Sysmon Installed)
        ↓
Splunk Universal Forwarder
        ↓
Splunk Enterprise (Ubuntu Server)

This configuration enables real-time log forwarding from the Windows endpoint to the SIEM platform.

---

## 2. Splunk Universal Forwarder Configuration (Windows)

Splunk Universal Forwarder was installed on the Windows machine to collect and forward Sysmon logs.

### 2.1 inputs.conf

Location:
C:\Program Files\SplunkUniversalForwarder\etc\system\local\inputs.conf

```ini
[WinEventLog://Microsoft-Windows-Sysmon/Operational]
index = sysmon
disabled = false

```

### Explanation:

WinEventLog://Microsoft-Windows-Sysmon/Operational → Collects Sysmon Operational logs.

index = sysmon → Logs are stored in the "sysmon" index in Splunk.

disabled = false → Log collection is enabled.

---

### 2.2 outputs.conf

Location:
C:\Program Files\SplunkUniversalForwarder\etc\system\local\outputs.conf

```ini

[tcpout]
defaultGroup = default-autolb-group

[tcpout:default-autolb-group]
server = 192.168.1.102:9997

[tcpout-server://192.168.1.102:9997]

```

### Explanation:

server = 192.168.1.102:9997 → Logs are forwarded to the Ubuntu Splunk server.

Port 9997 is the receiving port configured on Splunk Enterprise.

default-autolb-group → Default forwarding group used for load balancing (single server in this lab).

---

## 3. Splunk Enterprise (Ubuntu) – Receiving Configuration

On the Ubuntu server, Splunk Enterprise was configured to receive forwarded logs.

Receiving Port:
9997 (TCP)

Enabled via:

Settings → Forwarding and Receiving → Configure Receiving → New Receiving Port → 9997

---

## 4. Log Verification in Splunk

After configuration, Sysmon logs were successfully received and indexed.

Verification query used in Splunk:

```ini
index=sysmon
```

## 5. Result

✔ Sysmon installed and logging
✔ Universal Forwarder configured
✔ Secure log forwarding over TCP 9997
✔ Logs successfully indexed in Splunk

The centralized log collection pipeline is fully operational and ready for detection and analysis.
